server:
  port: ${SERVER_PORT:8081}

spring:
  config:
    import: optional:file:.env[.properties]
  application:
    name: auth-service

  # Database Configuration
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/auth_db}
    username: ${SPRING_DATASOURCE_USERNAME:postgres}
    password: ${SPRING_DATASOURCE_PASSWORD:postgres}

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        jdbc:
          time_zone: UTC

  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST:localhost}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      password: ${SPRING_DATA_REDIS_PASSWORD:}
      ssl:
        enabled: ${SPRING_DATA_REDIS_SSL_ENABLED:false}

  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            scope:
              - openid
              - email
              - profile
            redirect-uri: "http://localhost:8081/login/oauth2/code/google"

          apple:
            client-id: ${APPLE_CLIENT_ID:your-apple-service-id}
            client-secret: ${APPLE_CLIENT_SECRET:[dynamic]} # Will be generated dynamically
            client-authentication-method: client_secret_post
            authorization-grant-type: authorization_code
            scope:
              - openid
              - name
              - email
            redirect-uri: "http://localhost:8081/login/oauth2/code/apple"

        provider:
          apple:
            authorization-uri: https://appleid.apple.com/auth/authorize
            token-uri: https://appleid.apple.com/auth/token
            jwk-set-uri: https://appleid.apple.com/auth/keys
            user-name-attribute: sub

# JWT Configuration
jwt:
  access-token:
    secret: ${JWT_ACCESS_SECRET:f3b6c8e0a1d4f7a9c2e6b8d0a3f5c7e1b4d6a8f0c2e4b7d0a1f3e5c7a9b2d4e6}
    expiration-ms: ${JWT_ACCESS_EXPIRATION:3600000} # 1 hour
  refresh-token:
    secret: ${JWT_REFRESH_SECRET:9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0b9c8d7e6f5a4b3c2d1e0f9a8b}
    expiration-ms: ${JWT_REFRESH_EXPIRATION:604800000} # 7 days

# Apple Sign In Configuration
apple:
  team-id: ${APPLE_TEAM_ID:your-team-id}
  key-id: ${APPLE_KEY_ID:your-key-id}
  private-key: ${APPLE_PRIVATE_KEY:your-private-key}

# Frontend Configuration
app:
  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000}
  oauth2:
    redirect-uri: ${OAUTH2_REDIRECT_URI:http://localhost:3000/auth/callback}

# Twilio Configuration for SMS OTP
twilio:
  account-sid: ${TWILIO_ACCOUNT_SID:your-account-sid}
  auth-token: ${TWILIO_AUTH_TOKEN:your-auth-token}
  phone-number: ${TWILIO_PHONE_NUMBER:+15005550006}
  verify-service-sid: ${TWILIO_VERIFY_SERVICE_SID:#{null}}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      show-details: never
